## ã€ŒåŠ›æ‰£ã€ç¬¬ 239 é¢˜ï¼šæ»‘åŠ¨çª—å£çš„æœ€å¤§å€¼

é¢˜è§£åœ°å€ï¼š[æœ€å¤§ç´¢å¼•å † + åŒç«¯é˜Ÿåˆ—å­˜ç´¢å¼•å€¼çš„æ€è·¯åˆ†æï¼ˆPython ä»£ç ã€Java ä»£ç ï¼‰](https://leetcode-cn.com/problems/sliding-window-maximum/solution/zui-da-suo-yin-dui-shuang-duan-dui-lie-cun-suo-yin/)ã€‚

è¯´æ˜ï¼šæ–‡æœ¬é¦–å‘åœ¨åŠ›æ‰£çš„é¢˜è§£ç‰ˆå—ï¼Œæ›´æ–°ä¹Ÿä¼šåœ¨ç¬¬ 1 æ—¶é—´åœ¨ä¸Šé¢çš„ç½‘ç«™ä¸­æ›´æ–°ï¼Œè¿™ç¯‡æ–‡ç« åªæ˜¯ä¸Šé¢çš„æ–‡ç« çš„ä¸€ä¸ªå¿«ç…§ï¼Œæ‚¨å¯ä»¥ç‚¹å‡»ä¸Šé¢çš„é“¾æ¥çœ‹åˆ°å…¶ä»–ç½‘å‹å¯¹æœ¬æ–‡çš„è¯„è®ºã€‚

ä¼ é€é—¨ï¼š[239. æ»‘åŠ¨çª—å£æœ€å¤§å€¼](https://leetcode-cn.com/problems/sliding-window-maximum/)ã€‚

> ç»™å®šä¸€ä¸ªæ•°ç»„ numsï¼Œæœ‰ä¸€ä¸ªå¤§å°ä¸º k çš„æ»‘åŠ¨çª—å£ä»æ•°ç»„çš„æœ€å·¦ä¾§ç§»åŠ¨åˆ°æ•°ç»„çš„æœ€å³ä¾§ã€‚ä½ åªå¯ä»¥çœ‹åˆ°åœ¨æ»‘åŠ¨çª—å£ k å†…çš„æ•°å­—ã€‚æ»‘åŠ¨çª—å£æ¯æ¬¡åªå‘å³ç§»åŠ¨ä¸€ä½ã€‚
>
> è¿”å›æ»‘åŠ¨çª—å£æœ€å¤§å€¼ã€‚
>
> **è¿›é˜¶**ï¼š
>
> ä½ èƒ½åœ¨çº¿æ€§æ—¶é—´å¤æ‚åº¦å†…è§£å†³æ­¤é¢˜å—ï¼Ÿ
>
> ç¤ºä¾‹ï¼š
>
> ```
> è¾“å…¥: nums = [1, 3, -1, -3, 5, 3, 6, 7], å’Œ k = 3
> è¾“å‡º: [3, 3, 5, 5, 6, 7] 
> è§£é‡Šï¼š
> 
> æ»‘åŠ¨çª—å£çš„ä½ç½®                æœ€å¤§å€¼
> 
> ---------------               -----
> 
> [1  3  -1] -3  5  3  6  7       3
> 1 [3  -1  -3] 5  3  6  7       3
> 1  3 [-1  -3  5] 3  6  7       5
> 1  3  -1 [-3  5  3] 6  7       5
> 1  3  -1  -3 [5  3  6] 7       6
> 1  3  -1  -3  5 [3  6  7]      7
> ```
>
> æ³¨æ„ï¼š
>
> ä½ å¯ä»¥å‡è®¾ k æ€»æ˜¯æœ‰æ•ˆçš„ï¼Œ1 â‰¤ k â‰¤ è¾“å…¥æ•°ç»„çš„å¤§å°ï¼Œä¸”è¾“å…¥æ•°ç»„ä¸ä¸ºç©ºã€‚
>
> **æç¤ºï¼š**
>
> - `1 <= nums.length <= 10^5`
> - `-10^4 <= nums[i] <= 10^4`
> - `1 <= k <= nums.length`

## æœ€å¤§ç´¢å¼•å † + åŒç«¯é˜Ÿåˆ—å­˜ç´¢å¼•å€¼çš„æ€è·¯åˆ†æï¼ˆPython ä»£ç ã€Java ä»£ç ï¼‰

è¿™é“é—®é¢˜æœ€ç›´æ¥çš„æƒ³æ³•å°±æ˜¯â€œé€šè¿‡åˆ‡ç‰‡æ“ä½œå¾—åˆ°æ»‘åŠ¨çª—å£â€ï¼Œâ€œåˆ‡ç‰‡â€æ˜¯ Python ä¸­çš„ä¸€ä¸ªæ“ä½œï¼Œå³æˆªå–ä¸€ä¸ªåºåˆ—ï¼Œå¯ä»¥æ˜¯å­—ç¬¦ä¸²ä¹Ÿå¯ä»¥æ˜¯åˆ—è¡¨ï¼Œä¸­çš„**è¿ç»­**å­åºåˆ—ï¼Œå†ä»ä¸­å¾—åˆ°æœ€å¤§å€¼ï¼Œè¿™æ˜¯æš´åŠ›è§£æ³•ã€‚

- åŠ¨æ€å¾—åˆ°â€œæ»‘åŠ¨çª—å£â€çš„æœ€å¤§å€¼ï¼Œæœ‰ä¸€ä¸ªæ•°æ®ç»“æ„æ˜¯å®¹æ˜“æƒ³åˆ°çš„ï¼Œé‚£å°±æ˜¯â€œå †â€ï¼ˆâ€œä¼˜å…ˆé˜Ÿåˆ—â€ï¼‰ï¼Œç‰¹åˆ«åœ°ï¼Œåº”è¯¥ä½¿ç”¨â€œç´¢å¼•å †â€ã€‚
- æ ¹æ®[ã€ŒåŠ›æ‰£ã€ç¬¬ 155 é¢˜ï¼šæœ€å°æ ˆ](https://leetcode-cn.com/problems/min-stack/)è¿™ä¸ªé—®é¢˜çš„æ€è·¯ï¼Œæˆ‘ä»¬æƒ³åˆ°éœ€è¦ä¸€ä¸ªè¾…åŠ©çš„æ•°æ®ç»“æ„ï¼Œå½“â€œæ»‘åŠ¨çª—å£â€åœ¨ç§»åŠ¨çš„æ—¶å€™ï¼Œæˆ‘ä»¬ç›´æ¥çœ‹è¿™ä¸ªæ•°æ®ç»“æ„ï¼Œå°±å¯ä»¥å¾ˆå¿«çŸ¥é“æ­¤æ—¶â€œæ»‘åŠ¨çª—å£â€çš„æœ€å¤§å€¼ã€‚

é¢è¯•çš„æ—¶å€™ï¼Œå†™â€œåŒç«¯é˜Ÿåˆ—â€ï¼Œæˆ‘è‚¯å®šä¸¤ä¸ªæ€è·¯éƒ½å›ç­”ã€‚ä¸å†™â€œç´¢å¼•å †â€æ˜¯å› ä¸ºä»£ç é‡å¤ªå¤šï¼Œå¹¶ä¸”â€œå †â€æˆ‘æ˜¯å†™è¿‡å¾ˆå¤šéï¼Œä½†æ˜¯è¿˜æ˜¯ä¼šå†™ä¸å¥½çš„ï¼Œæ›´åˆ«è¯´â€œç´¢å¼•å †â€äº†ã€‚

â€œåŒç«¯é˜Ÿåˆ—å­˜ç´¢å¼•å€¼â€æ˜¯æˆ‘å‚è€ƒäº†ä¼—å¤šä¼˜ç§€çš„é¢˜è§£ä¹‹åæ€»ç»“å‡ºæ¥çš„ï¼Œå¸Œæœ›æˆ‘èƒ½å¤Ÿè§£é‡Šå‡ºä½¿ç”¨â€œåŒç«¯é˜Ÿåˆ—â€çš„åˆç†æ€§ã€‚åœ¨ç¼–å†™æœ¬é¢˜è§£çš„è¿‡ç¨‹ä¸­ï¼Œç”±äºè¦è§£é‡Šå¤§ä½¬ä»¬æ˜¯å¦‚ä½•æƒ³åˆ°â€œåŒç«¯é˜Ÿåˆ—â€çš„ï¼Œæˆ‘åˆæƒ³åˆ°äº†â€œç´¢å¼•å †â€ï¼Œä»¥å‰å­¦ä¹ â€œç´¢å¼•å †â€çš„æ—¶å€™è¢«è¿™ä¸ªä¸œè¥¿â€œæŠ˜ç£¨â€è¿‡ï¼Œæ‰€ä»¥å°è±¡æ¯”è¾ƒæ·±ï¼Œä¸è¿‡æˆ‘ä¸ªäººè§‰å¾—â€œç´¢å¼•å †â€çš„æ€æƒ³æ›´è‡ªç„¶ç›´æ¥ã€‚

### æ–¹æ³•ä¸€ï¼šåŒç«¯é˜Ÿåˆ—å­˜ç´¢å¼•å€¼

å¦‚æœä¸ä½¿ç”¨â€œç´¢å¼•å †â€è¦å®šä½è¦æ›´æ–°çš„å…ƒç´ çš„ç´¢å¼•ï¼Œè¿˜æ˜¯æœ‰ä¸€å®šæŠ€å·§çš„ï¼Œå½“ç„¶æŒ–æ˜é¢˜ç›®ä¸­çš„å·²çŸ¥æ¡ä»¶å¯ä»¥å¸®åŠ©æˆ‘ä»¬æ‰¾åˆ°è§£å†³æ–¹æ¡ˆã€‚

ï¼ˆ1ï¼‰æ ¹æ®[ã€ŒåŠ›æ‰£ã€ç¬¬ 155 é¢˜ï¼šæœ€å°æ ˆ](https://leetcode-cn.com/problems/min-stack/)è¿™ä¸ªé—®é¢˜çš„æ€è·¯ï¼Œæˆ‘ä»¬æƒ³åˆ°éœ€è¦ä¸€ä¸ªè¾…åŠ©çš„æ•°æ®ç»“æ„ï¼Œå½“â€œæ»‘åŠ¨çª—å£â€åœ¨ç§»åŠ¨çš„æ—¶å€™ï¼Œæˆ‘ä»¬ç›´æ¥çœ‹è¿™ä¸ªæ•°æ®ç»“æ„ï¼Œå°±å¯ä»¥å¾ˆå¿«çŸ¥é“æ­¤æ—¶â€œæ»‘åŠ¨çª—å£â€çš„æœ€å¤§å€¼ï¼›

ä¸‹é¢è¿™ä¸€ç‚¹æ˜¯å¾ˆå…³é”®çš„ï¼

> å¦‚æœâ€œå½“å‰è€ƒè™‘çš„æ•°â€æ¯”ä¹‹å‰æ¥çš„æ•°è¿˜è¦å¤§ï¼Œé‚£ä¹ˆä¹‹å‰çš„æ•°ï¼ˆå¦‚æœè¿˜æ²¡æœ‰åˆ’å‡ºâ€œæ»‘åŠ¨çª—å£â€ï¼‰å°±ä¸€å®šä¸ä¼šæ˜¯â€œæ»‘åŠ¨çª—å£â€çš„æœ€å¤§å€¼ï¼Œåº”è¯¥æŠŠå®ƒä»¬ç§»é™¤ï¼Œå› ä¸ºå®ƒä»¬â€œæ°¸è¿œä¸ä¼šæœ‰å‡ºå¤´ä¹‹æ—¥â€ã€‚

ï¼ˆ2ï¼‰æ ¹æ®ä¸Šé¢çš„åˆ†æï¼Œä¹‹å‰çš„æ•°ç¦»å¼€ï¼Œåæ¥çš„æ•°åŠ è¿›æ¥ï¼Œæ„Ÿè§‰è¿™ä¸ªæ•°æ®ç»“æ„å¯èƒ½æ˜¯â€œé˜Ÿåˆ—â€ï¼Œä½†æ˜¯ä¹‹å‰å¯èƒ½è¿˜æœ‰çš„æ•°æ¯”â€œå½“å‰è€ƒè™‘çš„æ•°â€è¿˜è¦å¤§ï¼Œè¿˜ä¸èƒ½å‡ºâ€œé˜Ÿåˆ—â€ï¼Œæ„Ÿè§‰è¿™ä¸ªæ•°æ®ç»“æ„è¿˜æœ‰å¯èƒ½æ˜¯â€œæ ˆâ€ï¼ˆä¸å¥½æ„æ€ï¼ŒåˆæŠŠä½ ç»•æ™•äº†ï¼Œä¸å¦¨å…ˆçœ‹åé¢ï¼‰ã€‚åˆæ„Ÿè§‰æ˜¯â€œé˜Ÿåˆ—â€ï¼Œåˆæ„Ÿè§‰æ˜¯â€œæ ˆâ€çš„ï¼Œæˆ‘ä»¬å…ˆåœä¸€ä¸‹ï¼Œè¿˜æœ‰ä¸€ä¸ªé—®é¢˜æ²¡æœ‰è§£å†³ï¼šå·¦è¾¹ç•Œå‡ºâ€œæ»‘åŠ¨çª—å£â€çš„æ—¶å€™æ€ä¹ˆåŠï¼Ÿã€‚

ï¼ˆ3ï¼‰â€œå·¦è¾¹ç•Œå‡ºæ»‘åŠ¨çª—å£çš„æ—¶å€™â€åªæœ‰ 1 ç§æƒ…å†µéœ€è¦è€ƒè™‘ï¼Œé‚£å°±æ˜¯ï¼š

> **å·¦è¾¹ç•Œæ°å¥½å°±æ˜¯ä¸Šä¸€è½®å¾ªç¯çš„æ»‘åŠ¨çª—å£çš„æœ€å¤§å€¼ï¼Œåœ¨è¿™ä¸€è½®â€œæ»‘åŠ¨çª—å£â€å³ç§»ï¼Œå®ƒå¿…é¡»è¢«ç§»å‡º**ã€‚

â€œå·¦è¾¹ç•Œå‡ºæ»‘åŠ¨çª—å£â€ï¼Œå·¦è¾¹ç•Œä¸€å®šæ¯”å½“å‰è€ƒè™‘çš„æ•°å…ˆè¿›è¿™ä¸ªè¾…åŠ©çš„æ•°æ®ç»“æ„ï¼Œ å†ç»“åˆ 3ï¼ˆ2ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥åˆ†æå‡ºè¿™ä¸ªè¾…åŠ©çš„æ•°æ®ç»“æ„å³è¦æ˜¯é˜Ÿåˆ—ï¼ˆå…ˆè¿›å…ˆå‡ºï¼‰ï¼Œä¹Ÿè¦æ˜¯æ ˆï¼ˆåè¿›å…ˆå‡ºï¼‰ï¼Œå› æ­¤â€œåŒç«¯é˜Ÿåˆ—â€æ˜¯é¦–é€‰ï¼Œå› ä¸ºè¦æ£€æµ‹åˆ°å·¦è¾¹ç•Œç§»é™¤ï¼Œå·¦è¾¹ç•Œçš„ç´¢å¼•å¾ˆé‡è¦ï¼ŒçŸ¥é“ç´¢å¼•ä¹Ÿå°±çŸ¥é“äº†å…·ä½“çš„å€¼ï¼Œ**å› æ­¤â€œåŒç«¯é˜Ÿåˆ—â€é‡Œå­˜çš„åº”è¯¥æ˜¯æ•°ç»„çš„ç´¢å¼•**ã€‚

**å‚è€ƒä»£ç  1**ï¼šâ€œæ»‘åŠ¨çª—å£â€å­˜æ”¾çš„æ˜¯æ•°ç»„çš„ç´¢å¼•å€¼ã€‚

Java ä»£ç ï¼š

Java

```Java
import java.util.ArrayDeque;
import java.util.ArrayList;
import java.util.List;

public class Solution {

    public int[] maxSlidingWindow(int[] nums, int k) {
        int len = nums.length;
        // ç‰¹åˆ¤
        if (len == 0) {
            return new int[]{};
        }
        // ç»“æœé›†
        List res = new ArrayList<>();
        // æ»‘åŠ¨çª—å£ï¼Œæ³¨æ„ï¼šä¿å­˜çš„æ˜¯ç´¢å¼•å€¼
        ArrayDeque deque = new ArrayDeque<>(k);

        for (int i = 0; i < len; i++) {
            // å½“å…ƒç´ ä»å·¦è¾¹ç•Œæ»‘å‡ºçš„æ—¶å€™ï¼Œå¦‚æœå®ƒæ°æ°å¥½æ˜¯æ»‘åŠ¨çª—å£çš„æœ€å¤§å€¼
            // é‚£ä¹ˆå°†å®ƒå¼¹å‡º
            if (i >= k && i - k == deque.getFirst()) {
                deque.pollFirst();
            }

            // å¦‚æœæ»‘åŠ¨çª—å£éç©ºï¼Œæ–°è¿›æ¥çš„æ•°æ¯”é˜Ÿåˆ—é‡Œå·²ç»å­˜åœ¨çš„æ•°è¿˜è¦å¤§
            // åˆ™è¯´æ˜å·²ç»å­˜åœ¨æ•°ä¸€å®šä¸ä¼šæ˜¯æ»‘åŠ¨çª—å£çš„æœ€å¤§å€¼ï¼ˆå®ƒä»¬æ¯«æ— å‡ºå¤´ä¹‹æ—¥ï¼‰
            // å°†å®ƒä»¬å¼¹å‡º
            while (!deque.isEmpty() && nums[deque.peekLast()] <= nums[i]) {
                deque.pollLast();
            }
            deque.add(i);
            // é˜Ÿé¦–ä¸€å®šæ˜¯æ»‘åŠ¨çª—å£çš„æœ€å¤§å€¼çš„ç´¢å¼•
            if (i >= k - 1) {
                res.add(nums[deque.peekFirst()]);
            }
        }

        int size = res.size();
        int[] result = new int[size];

        for (int i = 0; i < size; i++) {
            result[i] = res.get(i);
        }
        return result;
    }
}
```

Python ä»£ç ï¼š

Python

```Python
from typing import List
from collections import deque


class Solution:
    def maxSlidingWindow(self, nums: List[int], k: int) -> List[int]:
        size = len(nums)

        # ç‰¹åˆ¤
        if size == 0:
            return []
        # ç»“æœé›†
        res = []
        # æ»‘åŠ¨çª—å£ï¼Œæ³¨æ„ï¼šä¿å­˜çš„æ˜¯ç´¢å¼•å€¼
        window = deque()

        for i in range(size):
            # å½“å…ƒç´ ä»å·¦è¾¹ç•Œæ»‘å‡ºçš„æ—¶å€™ï¼Œå¦‚æœå®ƒæ°æ°å¥½æ˜¯æ»‘åŠ¨çª—å£çš„æœ€å¤§å€¼
            # é‚£ä¹ˆå°†å®ƒå¼¹å‡º
            if i >= k and i - k == window[0]:
                window.popleft()

            # å¦‚æœæ»‘åŠ¨çª—å£éç©ºï¼Œæ–°è¿›æ¥çš„æ•°æ¯”é˜Ÿåˆ—é‡Œå·²ç»å­˜åœ¨çš„æ•°è¿˜è¦å¤§
            # åˆ™è¯´æ˜å·²ç»å­˜åœ¨æ•°ä¸€å®šä¸ä¼šæ˜¯æ»‘åŠ¨çª—å£çš„æœ€å¤§å€¼ï¼ˆå®ƒä»¬æ¯«æ— å‡ºå¤´ä¹‹æ—¥ï¼‰
            # å°†å®ƒä»¬å¼¹å‡º
            while window and nums[window[-1]] <= nums[i]:
                window.pop()
            window.append(i)

            # é˜Ÿé¦–ä¸€å®šæ˜¯æ»‘åŠ¨çª—å£çš„æœ€å¤§å€¼çš„ç´¢å¼•
            if i >= k - 1:
                res.append(nums[window[0]])
        return res
```

### æ–¹æ³•äºŒï¼šä½¿ç”¨æœ€å¤§ç´¢å¼•å †

åŠ¨æ€å¾—åˆ°â€œæ»‘åŠ¨çª—å£â€çš„æœ€å¤§å€¼ï¼Œæœ‰ä¸€ä¸ªæ•°æ®ç»“æ„æ˜¯å®¹æ˜“æƒ³åˆ°çš„ï¼Œé‚£å°±æ˜¯â€œå †â€ï¼ˆâ€œä¼˜å…ˆé˜Ÿåˆ—â€ï¼‰ï¼Œä½†æ˜¯é—®é¢˜æ¥äº†ã€‚**å½“â€œæ»‘åŠ¨çª—å£â€è¦æŠŠå·¦è¾¹ç•Œç§»é™¤çš„æ—¶å€™ï¼Œæˆ‘ä»¬è™½ç„¶å·¦è¾¹ç•Œæ˜¯å“ªä¸ªå…ƒç´ ï¼Œä½†æ˜¯æ²¡æœ‰ä»ä¸€ä¸ªå †ä¸­ç§»é™¤éæœ€å †é¡¶å…ƒç´ çš„æ“ä½œ**ï¼Œäºæ˜¯æˆ‘å°±æƒ³â€œç´¢å¼•å †â€å¯ä¸å¯ä»¥å‘¢ï¼Ÿæ‰¾åˆ°å³å°†è¦æ»‘å‡ºè¾¹ç•Œçš„é‚£ä¸ªç´¢å¼•ï¼Œæ›´æ–°ä¸€ä¸‹å®ƒçš„å€¼å°±å¥½ï¼Œé‚£ä¹ˆç´¢å¼•å€¼å¦‚ä½•æ›´æ–°å‘¢ï¼Ÿåœ¨çº¸ä¸Šå†™ä¸€å†™ï¼Œä½ å°±ä¼šå‘ç°è§„å¾‹ï¼š**æ–°è¿›æ¥çš„é‚£ä¸ªæ•°çš„ç´¢å¼•ï¼ŒæŠŠè‡ªå·±è¿™ä¸ªç´¢å¼•å¯¹ ğ‘˜k å–æ¨¡çš„é‚£ä¸ªç´¢å¼•æ›´æ–°ä¸€ä¸‹å°±å¥½äº†**ã€‚

> ä½¿ç”¨â€œç´¢å¼•å †â€çš„åŸå› ï¼šâ€œç´¢å¼•å †â€æœ‰ä¸€ä¸ªæ›´æ–°æ“ä½œï¼Œå¯ä»¥é’ˆå¯¹æŸä¸ªç´¢å¼•æ›´æ–°å®ƒçš„å€¼ï¼Œç„¶åç´¢å¼•å‘ç”Ÿè°ƒæ•´ï¼Œä½¿å¾—ç´¢å¼•æ•°ç»„ç»„æˆæœ€å¤§å †ã€‚**å› ä¸ºèƒ½æ–¹ä¾¿åœ°å®šä½åˆ°æŸä¸ªå…ƒç´ ï¼Œå› æ­¤å¯ä»¥åœ¨æ–°è¿›æ¥ä¸€ä¸ªæ•°çš„æ—¶å€™ï¼Œä½¿ç”¨æ›´æ–°æ“ä½œï¼ŒæŠŠé©¬ä¸Šè¦å‡ºâ€œæ»‘åŠ¨çª—å£â€çš„é‚£ä¸ªç´¢å¼•ä½ç½®ä¸Šçš„å€¼æ›´æ–°æˆæ–°è¿›æ¥çš„è¿™ä¸ªæ•°çš„å€¼å°±å¯ä»¥äº†ï¼ˆè¯´èµ·æ¥å¾ˆæ‹—å£ï¼Œçœ‹ä»£ç ä¼šç®€æ´å¾ˆå¤šï¼‰ã€‚**



![239-1.png](https://pic.leetcode-cn.com/48079c3b0136326886cf00ccf0b70c37f5a6dc4756cdcee6e1fc6e9d79a4b781-239-1.png)

**239-1.png**



ä¸è¿‡å¾ˆçº ç»“çš„æ˜¯ Python å’Œ Java éƒ½æ²¡æœ‰ç°æˆçš„â€œç´¢å¼•å †â€ï¼Œéœ€è¦è‡ªå·±ç¼–å†™ï¼Œè¯·è§â€œå‚è€ƒä»£ç  2â€ã€‚

- å¯¹â€œç´¢å¼•å †â€æ„Ÿå…´è¶£çš„æœ‹å‹ï¼Œå¯ä»¥å‚è€ƒæˆ‘çš„å­¦ä¹ ç¬”è®°[ã€Šã€ç®—æ³•æ—¥ç§¯æœˆç´¯ã€‘11-ç´¢å¼•å †ã€‹](https://www.liwei.party/2019/01/12/algorithms-and-data-structures/index-heap/)ï¼Œæ³¨æ„æ–‡ä¸­æåˆ°çš„â€œç´¢å¼•æ•°ç»„â€å’Œâ€œåå‘æŸ¥æ‰¾â€æŠ€å·§æ˜¯å€¼å¾—å€Ÿé‰´çš„ï¼Œæ–‡åè¿˜ç»™å‡ºäº†ç¤ºä¾‹ä»£ç å’Œå‚è€ƒèµ„æ–™ã€‚

**å‚è€ƒä»£ç  2**ï¼šâ€œæœ€å¤§ç´¢å¼•å †â€å¾—è‡ªå·±å†™ï¼Œæ­£å¥½å°±åˆ©ç”¨äº† LeetCode çš„æµ‹è¯•ç”¨ä¾‹æ£€éªŒä¸€ä¸‹è‡ªå·±æœ‰æ²¡æœ‰å†™å¯¹ã€‚

Python ä»£ç ï¼š

Python

```Python
from typing import List


class Solution:

    def maxSlidingWindow(self, nums: List[int], k: int) -> List[int]:
        size = len(nums)

        # ç‰¹åˆ¤
        if size == 0:
            return []

        # åˆå§‹åŒ–æœ€å¤§ç´¢å¼•å †ï¼Œå…¶å®¹é‡æ˜¯æ»‘åŠ¨çª—å£çš„å¤§å°
        index_max_heap = Solution.IndexMaxHeap(k)
        # é¦–å…ˆå…ˆæŠŠå‰ k ä¸ªå…ƒç´ åŠ è¿›å»
        for i in range(k):
            index_max_heap.insert(i, nums[i])

        # ç»“æœé›†
        res = []
        # ç„¶åå°±æ˜¯äº§ç”Ÿæ»‘åŠ¨çª—å£çš„è¿‡ç¨‹ï¼Œå…ˆè¾“å‡ºæœ€å¤§å€¼ï¼Œ
        # è€ŒåæŠŠå½“å‰è€ƒè™‘çš„æ•°æ’å…¥åˆ°å°†è¦æ»‘å‡ºçš„å·¦è¾¹ç•Œçš„ç´¢å¼•ä½ç½®

        for i in range(k, size):
            res.append(index_max_heap.peek_max_value())
            index_max_heap.change(i % k, nums[i])
        # å› ä¸ºæœ€å¤§ç´¢å¼•å †æ›´æ–°äº†æœ€å 1 ä¸ªæ•°ï¼Œå› æ­¤æœ€åè¿˜è¦çœ‹ä¸€çœ¼æœ€å¤§å€¼
        res.append(index_max_heap.peek_max_value())
        return res

    class IndexMaxHeap:
        def __init__(self, capacity):
            self.data = [None for _ in range(capacity + 1)]
            # åˆå€¼è®¾ç½®ä¸º 0 ï¼Œè¡¨ç¤ºè¯¥ä½ç½®è¿˜æ²¡æœ‰æ”¾ç½®å…ƒç´ 
            self.indexes = [0 for _ in range(capacity + 1)]
            self.reverse = [0 for _ in range(capacity + 1)]
            self.count = 0
            self.capacity = capacity

        def size(self):
            return self.count

        def is_empty(self):
            return self.count == 0

        # æ­¤æ—¶ insert è¦ç»™ä¸€ä¸ªç´¢å¼•ä½ç½®
        def insert(self, i, item):
            if self.count + 1 > self.capacity:
                raise Exception('å †çš„å®¹é‡ä¸å¤Ÿäº†')
            i += 1
            self.data[i] = item

            # è¿™ä¸€æ­¥å¾ˆå…³é”®ï¼Œåœ¨å†…éƒ¨ç´¢å¼•æ•°ç»„çš„æœ€åè®¾ç½®ç´¢å¼•æ•°ç»„çš„ç´¢å¼•
            self.indexes[self.count + 1] = i
            self.reverse[i] = self.count + 1

            self.count += 1
            self.__shift_up(self.count)

        def __shift_up(self, k):
            while k > 1 and self.data[self.indexes[k // 2]] < self.data[self.indexes[k]]:
                self.indexes[k // 2], self.indexes[k] = self.indexes[k], self.indexes[k // 2]

                self.reverse[self.indexes[k // 2]] = k // 2
                self.reverse[self.indexes[k]] = k

                k //= 2

        def extract_max(self):
            if self.count == 0:
                raise Exception('å †é‡Œæ²¡æœ‰å¯ä»¥å–å‡ºçš„å…ƒç´ ')
            ret = self.data[self.indexes[1]]
            self.indexes[1], self.indexes[self.count] = self.indexes[self.count], self.indexes[1]
            self.reverse[self.indexes[1]] = 1
            self.reverse[self.indexes[self.count]] = self.count

            self.reverse[self.indexes[self.count]] = 0

            self.count -= 1
            self.__shift_down(1)
            return ret

        def __shift_down(self, k):
            while 2 * k <= self.count:
                j = 2 * k
                if j + 1 <= self.count and self.data[self.indexes[j + 1]] > self.data[self.indexes[j]]:
                    j = j + 1
                if self.data[self.indexes[k]] >= self.data[self.indexes[j]]:
                    break
                self.indexes[k], self.indexes[j] = self.indexes[j], self.indexes[k]

                self.reverse[self.indexes[k]] = k
                self.reverse[self.indexes[j]] = j

                k = j

        # æ–°å¢æ–¹æ³•
        def extract_max_index(self):
            assert self.count > 0
            # å‡ 1 æ˜¯ä¸ºäº†ç¬¦åˆç”¨æˆ·è§†è§’
            ret = self.indexes[1] - 1
            self.indexes[1], self.indexes[self.count] = self.indexes[self.count], self.indexes[1]
            self.count -= 1
            self.__shift_down(1)
            return ret

        # æ–°å¢æ–¹æ³•
        def get_item(self, i):
            # å†…éƒ¨æ•°ç»„çš„ç´¢å¼•æ¯”ç”¨æˆ·è§†è§’å¤š 1
            return self.data[i + 1]

        # æ–°å¢æ–¹æ³•
        def change(self, i, new_item):
            # æŠŠç”¨æˆ·è§†è§’æ”¹æˆå†…éƒ¨ç´¢å¼•
            i += 1
            self.data[i] = new_item

            # é‡ç‚¹ï¼šä¸‹é¢è¿™ä¸€æ­¥æ˜¯æ‰¾åŸæ¥æ•°ç»„ä¸­ç´¢å¼•æ˜¯ i çš„å…ƒç´ 
            # åœ¨ç´¢å¼•æ•°ç»„ä¸­çš„ç´¢å¼•æ˜¯å‡ ï¼Œè¿™æ˜¯ä¸€ä¸ªå”¯ä¸€å€¼ï¼Œæ‰¾åˆ°å³è¿”å›
            # ä¼˜åŒ–ï¼šå¯ä»¥å¼•å…¥åå‘æŸ¥æ‰¾æŠ€æœ¯ä¼˜åŒ–

            j = self.reverse[i]
            self.__shift_down(j)
            self.__shift_up(j)

        # ä¸º LeetCode ç¬¬ 239 é¢˜æ–°å¢çš„æ–¹æ³•ï¼Œçœ‹ä¸€çœ¼æ­¤æ—¶ç´¢å¼•å †çš„æœ€å¤§ç´¢å¼•æ˜¯å¤šå°‘ï¼ˆæ²¡ç”¨ä¸Šï¼Œæˆ‘æƒ³å¤šäº†ï¼Œç•™åˆ°ä»¥åç”¨å§ï¼‰
        def peek_max_index(self):
            if self.count == 0:
                raise Exception('å †é‡Œæ²¡æœ‰å¯ä»¥å–å‡ºçš„å…ƒç´ ')
            # æ³¨æ„ï¼šä¸ç”¨æˆ·è®¤ä¸ºçš„ç´¢å¼•å€¼æœ‰ä¸€ä¸ªåå·®
            return self.indexes[1] - 1

        # ä¸º LeetCode ç¬¬ 239 é¢˜æ–°å¢çš„æ–¹æ³•ï¼Œçœ‹ä¸€çœ¼æ­¤æ—¶ç´¢å¼•å †çš„æœ€å¤§å€¼æ˜¯å¤šå°‘
        def peek_max_value(self):
            if self.count == 0:
                raise Exception('å †é‡Œæ²¡æœ‰å¯ä»¥å–å‡ºçš„å…ƒç´ ')
            return self.data[self.indexes[1]]


if __name__ == '__main__':
    solution = Solution()
    nums = [1, 3, -1, -3, 5, 3, 6, 7]
    k = 3
    res = solution.maxSlidingWindow(nums, k)
    print(res)
```

Java ä»£ç ï¼š

Java

```Java
import java.util.Arrays;

/**
 * @author liwei
 * @date 2019/7/10 9:27 AM
 */
public class Solution2 {

    public int[] maxSlidingWindow(int[] nums, int k) {
        int len = nums.length;
        if (len == 0) {
            return new int[]{};
        }

        // åˆå§‹åŒ–æœ€å¤§ç´¢å¼•å †ï¼Œå…¶å®¹é‡æ˜¯æ»‘åŠ¨çª—å£çš„å¤§å°
        IndexMaxHeap indexMaxHeap = new IndexMaxHeap(k);

        // é¦–å…ˆå…ˆæŠŠå‰ k ä¸ªå…ƒç´ åŠ è¿›å»
        for (int i = 0; i < k; i++) {
            indexMaxHeap.insert(i, nums[i]);
        }

        // ç»“æœé›†
        int[] res = new int[len - k + 1];

        // ç„¶åå°±æ˜¯äº§ç”Ÿæ»‘åŠ¨çª—å£çš„è¿‡ç¨‹ï¼Œå…ˆè¾“å‡ºæœ€å¤§å€¼ï¼Œ
        // è€ŒåæŠŠå½“å‰è€ƒè™‘çš„æ•°æ’å…¥åˆ°å°†è¦æ»‘å‡ºçš„å·¦è¾¹ç•Œçš„ç´¢å¼•ä½ç½®
        for (int i = k; i < len; i++) {
            res[i - k] = indexMaxHeap.peekMaxValue();
            indexMaxHeap.change(i % k, nums[i]);
        }
        // å› ä¸ºæœ€å¤§ç´¢å¼•å †æ›´æ–°äº†æœ€å 1 ä¸ªæ•°ï¼Œå› æ­¤æœ€åè¿˜è¦çœ‹ä¸€çœ¼æœ€å¤§å€¼
        res[len - k] = indexMaxHeap.peekMaxValue();
        return res;
    }


    class IndexMaxHeap {

        private int[] data;
        private int count;
        private int capacity;
        private int[] indexes;
        private int[] reverse;

        // ä½¿ç”¨äº†åå‘æŸ¥æ‰¾æŠ€æœ¯çš„æœ€å¤§ç´¢å¼•å †

        public IndexMaxHeap(int capacity) {
            data = new int[capacity + 1];
            indexes = new int[capacity + 1];
            reverse = new int[capacity + 1];
            count = 0;
            this.capacity = capacity;
        }


        public int getSize() {
            return count;
        }


        public boolean isEmpty() {
            return count == 0;
        }


        public void insert(int i, int item) {
            assert count + 1 <= capacity;
            assert i + 1 >= 1 && i + 1 <= capacity;
            i += 1;
            data[i] = item;

            indexes[count + 1] = i;
            reverse[i] = indexes[count + 1];

            count++;
            shiftUp(count);
        }


        private void shiftUp(int k) {
            while (k > 1 && data[indexes[k / 2]] < data[indexes[k]]) {

                swap(indexes, k / 2, k);
                // æ³¨æ„åˆ†æè¿™è¡Œä»£ç ï¼Œå³ä½¿ä¸Šä¸€è¡Œ indexes çš„ä¸¤ä¸ªå…ƒç´ äº¤æ¢äº†ä½ç½®ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰æ”¹å˜ä»–ä»¬çš„å€¼
                // æ¯ä¸€æ¬¡äº¤æ¢äº† indexes ç´¢å¼•ä»¥åï¼Œè¿˜è¦æŠŠ reverse ç´¢å¼•ä¹Ÿäº¤æ¢
                swap(reverse, indexes[k / 2], indexes[k]);

                k /= 2;
            }
        }


        private void shiftUp1(int k) {
            while (k > 1 && data[indexes[k / 2]] < data[indexes[k]]) {
                swapIndexes(k / 2, k);
                k /= 2;
            }
        }


        private void swapIndexes(int index1, int index2) {
            if (index1 == index2) {
                return;
            }
            int temp = indexes[index1];
            indexes[index1] = indexes[index2];
            indexes[index2] = temp;

            reverse[indexes[index1]] = index2;
            reverse[indexes[index2]] = index1;
        }


        private void swap(int[] data, int index1, int index2) {
            if (index1 == index2) {
                return;
            }
            int temp = data[index1];
            data[index1] = data[index2];
            data[index2] = temp;
        }


        /**
         * @return
         */
        public int extractMax() {
            // å°†æ­¤æ—¶äºŒå‰å †ä¸­çš„æœ€å¤§çš„é‚£ä¸ªæ•°æ®åˆ é™¤ï¼ˆå‡ºé˜Ÿï¼‰ï¼Œè¿”å›çš„æ˜¯æ•°æ®ï¼Œä¸æ˜¯è¿”å›ç´¢å¼•
            assert count > 0;
            int ret = data[indexes[1]];
            // åªè¦è®¾è®¡äº¤æ¢çš„æ“ä½œï¼Œå°±ä¸€å®šæ˜¯ç´¢å¼•æ•°ç»„äº¤æ¢
            // æ¯ä¸€æ¬¡äº¤æ¢äº† indexes ç´¢å¼•ä»¥åï¼Œè¿˜è¦æŠŠ reverse ç´¢å¼•ä¹Ÿäº¤æ¢
            swap(indexes, 1, count);
            swap(reverse, indexes[1], indexes[count]);
            count--;
            shiftDown(1);
            return ret;
        }


        /**
         * @return
         */
        public int extractMax1() {
            // å°†æ­¤æ—¶äºŒå‰å †ä¸­çš„æœ€å¤§çš„é‚£ä¸ªæ•°æ®åˆ é™¤ï¼ˆå‡ºé˜Ÿï¼‰ï¼Œè¿”å›çš„æ˜¯æ•°æ®ï¼Œä¸æ˜¯è¿”å›ç´¢å¼•
            assert count > 0;
            int ret = data[indexes[1]];
            // åªè¦è®¾è®¡äº¤æ¢çš„æ“ä½œï¼Œå°±ä¸€å®šæ˜¯ç´¢å¼•æ•°ç»„äº¤æ¢
            // æ¯ä¸€æ¬¡äº¤æ¢äº† indexes ç´¢å¼•ä»¥åï¼Œè¿˜è¦æŠŠ reverse ç´¢å¼•ä¹Ÿäº¤æ¢
            swapIndexes(1, count);
            count--;
            shiftDown(1);
            return ret;
        }


        private void shiftDown(int k) {
            while (2 * k <= count) {
                int j = 2 * k;
                if (j + 1 <= count && data[indexes[j + 1]] > data[indexes[j]]) {
                    j = j + 1;
                }
                if (data[indexes[k]] >= data[indexes[j]]) {
                    break;
                }

                // æ¯ä¸€æ¬¡äº¤æ¢äº† indexes ç´¢å¼•ä»¥åï¼Œè¿˜è¦æŠŠ reverse ç´¢å¼•ä¹Ÿäº¤æ¢
                swap(indexes, k, j);
                swap(reverse, indexes[k], indexes[j]);

                k = j;
            }
        }


        private void shiftDown1(int k) {
            while (2 * k <= count) {
                int j = 2 * k;
                if (j + 1 <= count && data[indexes[j + 1]] > data[indexes[j]]) {
                    j = j + 1;
                }
                if (data[indexes[k]] >= data[indexes[j]]) {
                    break;
                }
                // æ¯ä¸€æ¬¡äº¤æ¢äº† indexes ç´¢å¼•ä»¥åï¼Œè¿˜è¦æŠŠ reverse ç´¢å¼•ä¹Ÿäº¤æ¢
                swapIndexes(k, j);
                k = j;
            }
        }


        public int extractMaxIndex() {
            assert count > 0;
            int ret = indexes[1] - 1;

            // æ¯ä¸€æ¬¡äº¤æ¢äº† indexes ç´¢å¼•ä»¥åï¼Œè¿˜è¦æŠŠ reverse ç´¢å¼•ä¹Ÿäº¤æ¢
            swap(indexes, 1, count);
            swap(reverse, indexes[1], indexes[count]);

            count--;
            shiftDown(1);
            return ret;
        }


        public int extractMaxIndex1() {
            assert count > 0;
            int ret = indexes[1] - 1;
            // æ¯ä¸€æ¬¡äº¤æ¢äº† indexes ç´¢å¼•ä»¥åï¼Œè¿˜è¦æŠŠ reverse ç´¢å¼•ä¹Ÿäº¤æ¢
            swapIndexes(1, count);
            count--;
            shiftDown(1);
            return ret;
        }


        public int getItem(int i) {
            return data[i + 1];
        }


        public void change(int i, int item) {
            i = i + 1;
            data[i] = item;

            // åŸå…ˆéå†çš„æ“ä½œï¼Œç°åœ¨å°±å˜æˆäº†è¿™ä¸€æ­¥ï¼Œæ˜¯ä¸æ˜¯å¾ˆé…·
            int j = reverse[i];
            shiftDown(j);
            shiftUp(j);
        }


        /**
         * ä¸º LeetCode ç¬¬ 239 é¢˜æ–°å¢çš„æ–¹æ³•ï¼Œ
         * çœ‹ä¸€çœ¼æ­¤æ—¶ç´¢å¼•å †çš„æœ€å¤§ç´¢å¼•æ˜¯å¤šå°‘ï¼ˆæ²¡ç”¨ä¸Šï¼Œæˆ‘æƒ³å¤šäº†ï¼Œç•™åˆ°ä»¥åç”¨å§ï¼‰
         *
         * @return
         */
        public int peekMaxIndex() {
            if (this.count == 0) {
                throw new RuntimeException("å †é‡Œæ²¡æœ‰å¯ä»¥å–å‡ºçš„å…ƒç´ ");
            }
            // æ³¨æ„ï¼šä¸ç”¨æˆ·è®¤ä¸ºçš„ç´¢å¼•å€¼æœ‰ä¸€ä¸ªåå·®
            return indexes[1] - 1;
        }

        /**
         * ä¸º LeetCode ç¬¬ 239 é¢˜æ–°å¢çš„æ–¹æ³•ï¼Œ
         * çœ‹ä¸€çœ¼æ­¤æ—¶ç´¢å¼•å †çš„æœ€å¤§ç´¢å¼•æ˜¯å¤šå°‘ï¼ˆæ²¡ç”¨ä¸Šï¼Œæˆ‘æƒ³å¤šäº†ï¼Œç•™åˆ°ä»¥åç”¨å§ï¼‰
         *
         * @return
         */
        public int peekMaxValue() {
            if (this.count == 0) {
                throw new RuntimeException("å †é‡Œæ²¡æœ‰å¯ä»¥å–å‡ºçš„å…ƒç´ ");
            }
            return data[indexes[1]];
        }
    }

    public static void main(String[] args) {
        Solution2 solution2 = new Solution2();
        int[] nums = {1, 3, -1, -3, 5, 3, 6, 7};
        int k = 3;

        int[] res = solution2.maxSlidingWindow(nums, k);
        System.out.println(Arrays.toString(res));
    }
}
```