## ã€ŒåŠ›æ‰£ã€ç¬¬ 220 é¢˜ï¼šå­˜åœ¨é‡å¤å…ƒç´  III

ä¼ é€é—¨ï¼š[220. å­˜åœ¨é‡å¤å…ƒç´  III](https://leetcode-cn.com/problems/contains-duplicate-iii/)ï¼›

é¢˜è§£åœ°å€ï¼š[æ»‘åŠ¨çª—å£ + äºŒå‰æœç´¢æ ‘æ‰¾ä¸Šä¸‹è¾¹ç•Œï¼ˆPython ä»£ç ã€Java ä»£ç ï¼‰](https://www.liwei.party/2017/06/22/leetcode-algo/0209-minimum-size-subarray-sum/)ã€‚

> ç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„ï¼Œåˆ¤æ–­æ•°ç»„ä¸­æ˜¯å¦æœ‰ä¸¤ä¸ªä¸åŒçš„ç´¢å¼• `i` å’Œ `j`ï¼Œä½¿å¾— `nums [i]` å’Œ `nums [j]` çš„å·®çš„ç»å¯¹å€¼æœ€å¤§ä¸º `t`ï¼Œå¹¶ä¸” `i` å’Œ `j` ä¹‹é—´çš„å·®çš„ç»å¯¹å€¼æœ€å¤§ä¸º `Ä·`ã€‚
>
> ç¤ºä¾‹ 1:
>
> ```
> è¾“å…¥: nums = [1,2,3,1], k = 3, t = 0
> è¾“å‡º: true
> ```
>
> ç¤ºä¾‹ 2ï¼š
>
> ```
> è¾“å…¥: nums = [1,0,1,1], k = 1, t = 2
> è¾“å‡º: true
> ```
>
> ç¤ºä¾‹ 3ï¼š
>
> ```
> è¾“å…¥: nums = [1,5,9,1,5,9], k = 2, t = 3
> è¾“å‡º: false
> ```



è¿™é“é¢˜å¾—å…ˆè¯»æ‡‚é¢˜ç›®çš„æ„æ€ï¼šå­˜åœ¨æ€§é—®é¢˜ï¼Œæ‰¾åˆ°ç¬¦åˆé¢˜æ„çš„â€œæ•°æ®å¯¹â€å³å¯è¿”å› `true`ï¼Œæ‰€æœ‰å¯èƒ½çš„æƒ…å†µéƒ½çœ‹å®Œä»¥åæ²¡æœ‰æ‰¾åˆ°æ‰è¿”å› `false`ã€‚

é¢˜ç›®æ„æ€ç¿»è¯‘ä¸€ä¸‹ï¼š**åœ¨æ•°ç»„ `nums[i]` ä¸­ï¼Œåœ¨ä»»æ„æœ‰æ•ˆåŒºé—´ `[i, i + k]` é‡Œæ˜¯å¦å­˜åœ¨ä¸¤ä¸ªæ•°çš„ç»å¯¹å€¼å°äºç­‰äº `t`**ï¼Œå­˜åœ¨åˆ™è¿”å› `true`ï¼Œä¸å­˜åœ¨è¿”å› `false`ã€‚

### æ–¹æ³•ä¸€ï¼šæš´åŠ›è§£æ³•

æšä¸¾æ‰€æœ‰é•¿åº¦å°äºç­‰äº `k + 1` çš„â€œä¸‹æ ‡å¯¹`ï¼ˆï¼‰`â€ï¼Œåªè¦å‘ç° `nums[i] - nums[j]` çš„ç»å¯¹å€¼å°äº `t` ï¼Œå°±è¿”å› `true`ã€‚

**å‚è€ƒä»£ç  1**ï¼š

Java

```Java
public class Solution {

    public boolean containsNearbyAlmostDuplicate(int[] nums, int k, int t) {
        int len = nums.length;
        long a;
        long b;

        for (int i = 0; i < len; i++) {
            for (int j = i + 1; j < len && j <= i + k; j++) {
                a = nums[i];
                b = nums[j];
                if (Math.abs(a - b) <= t) {
                    return true;
                }
            }
        }
        return false;
    }
}
```

**å¤æ‚åº¦åˆ†æ**ï¼š

- æ—¶é—´å¤æ‚åº¦ï¼šğ‘‚(ğ‘2)O(N2)ï¼Œè¿™é‡Œæ•°ç»„çš„é•¿åº¦ä¸º ğ‘Nï¼Œæšä¸¾å¯èƒ½çš„æ•°å¯¹ (ğ‘–,ğ‘—)(i,j) ã€‚
- ç©ºé—´å¤æ‚åº¦ï¼šğ‘‚(1)O(1)ã€‚

å¾ˆå®¹æ˜“æƒ³åˆ°çš„ä¼˜åŒ–çš„æ€è·¯æ˜¯ï¼šä»¥ç©ºé—´æ¢æ—¶é—´ï¼Œè¿™é‡Œçš„ç©ºé—´è¿˜éœ€è¦æœ‰æ¯”è¾ƒå¤§å°çš„åŠŸèƒ½ï¼Œæ¯”è¾ƒå®¹æ˜“æƒ³åˆ°çš„æ•°æ®ç»“æ„æ˜¯äºŒå‰æœç´¢æ ‘ã€‚

### æ–¹æ³•äºŒï¼šæ»‘åŠ¨çª—å£ï¼ˆä»¥ç©ºé—´æ¢æ—¶é—´ï¼‰

> å›ºå®šé•¿åº¦çš„æ»‘åŠ¨çª—å£é—®é¢˜ã€‚å’Œ 3ã€76ã€209 è¿˜ä¸å¤ªä¸€æ ·ã€‚

é¢˜ç›®æ„æ€ç¿»è¯‘ä¸€ä¸‹ï¼šåœ¨æ•°ç»„ `nums[i]` ä¸­ï¼Œåœ¨ä»»æ„æœ‰æ•ˆåŒºé—´ `[i, i + k]` é‡Œæ˜¯å¦å­˜åœ¨ä¸¤ä¸ªæ•°çš„ç»å¯¹å€¼å°äºç­‰äº `t`ï¼Œå³



|ğ‘›ğ‘¢ğ‘šğ‘ [ğ‘–]âˆ’ğ‘›ğ‘¢ğ‘šğ‘ [ğ‘—]|<=ğ‘¡|nums[i]âˆ’nums[j]|<=t



ç­‰ä»·äº ğ‘›ğ‘¢ğ‘šğ‘ [ğ‘–]âˆ’ğ‘›ğ‘¢ğ‘šğ‘ [ğ‘—]<=ğ‘¡nums[i]âˆ’nums[j]<=t å¹¶ä¸” ğ‘›ğ‘¢ğ‘šğ‘ [ğ‘–]âˆ’ğ‘›ğ‘¢ğ‘šğ‘ [ğ‘—]>=âˆ’ğ‘¡nums[i]âˆ’nums[j]>=âˆ’tï¼Œ

æ•´ç†å¾—ï¼šğ‘›ğ‘¢ğ‘šğ‘ [ğ‘–]<=ğ‘¡+ğ‘›ğ‘¢ğ‘šğ‘ [ğ‘—]nums[i]<=t+nums[j] å¹¶ä¸” ğ‘›ğ‘¢ğ‘šğ‘ [ğ‘–]>=ğ‘›ğ‘¢ğ‘šğ‘ [ğ‘—]âˆ’ğ‘¡nums[i]>=nums[j]âˆ’tã€‚

äºæ˜¯ç®—æ³•å¯ä»¥åœ¨éå†çš„æ—¶å€™ï¼ŒæŠŠéå†åˆ°çš„æ•°å­˜åˆ° `BST` ä¸­ï¼Œè¾¹éå†è¾¹æŸ¥æ‰¾ã€‚

æ ¹æ®åˆšæ‰å¾—åˆ°å¼å­ ğ‘›ğ‘¢ğ‘šğ‘ [ğ‘–]>=ğ‘›ğ‘¢ğ‘šğ‘ [ğ‘—]âˆ’ğ‘¡nums[i]>=nums[j]âˆ’tï¼Œå‡è®¾å½“å‰éå†åˆ°çš„æ•°æ˜¯ ğ‘›ğ‘¢ğ‘šğ‘ [ğ‘—]nums[j]ï¼Œğ‘›ğ‘¢ğ‘šğ‘ [ğ‘–]nums[i] å°±æ˜¯ ğ‘›ğ‘¢ğ‘šğ‘ [ğ‘—]âˆ’ğ‘¡nums[j]âˆ’t çš„å¤©èŠ±æ¿æ•°ï¼ˆ`ceiling`ï¼‰ï¼Œè¿™ä¸ªæ•°åŒæ—¶è¿˜è¦å°äºç­‰äº ğ‘¡+ğ‘›ğ‘¢ğ‘šğ‘ [ğ‘—]t+nums[j]ã€‚æ ¹æ®è¿™ä¸€ç‚¹å†™æ»‘åŠ¨çª—å£çš„ä»£ç ã€‚

- `ceiling(key)` å‡½æ•°ï¼šè¿”å›å¤§äºç­‰äº `key` çš„æœ€å°å…ƒç´ ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œè¿”å›ç©ºã€‚ä¸‹é¢çš„æ˜¯è¿™ä¸ªå‡½æ•°çš„æ–‡æ¡£ï¼ˆé€šè¿‡ Intellij IDEA æŸ¥çœ‹ï¼‰ã€‚

Java

```Java
/**
  * Returns the least key greater than or equal to the given key,
  * or {@code null} if there is no such key.
  *
  * @param key the key
  * @return the least key greater than or equal to {@code key},
  *         or {@code null} if there is no such key
  * @throws ClassCastException if the specified key cannot be compared
  *         with the keys currently in the map
  * @throws NullPointerException if the specified key is null
  *         and this map does not permit null keys
  */
K ceilingKey(K key);
```

**å‚è€ƒä»£ç  2**ï¼š

Java

```Java
import java.util.TreeSet;

public class Solution {

    public boolean containsNearbyAlmostDuplicate(int[] nums, int k, int t) {
        // æ»‘åŠ¨çª—å£ç»“åˆæŸ¥æ‰¾è¡¨ï¼Œæ­¤æ—¶æ»‘åŠ¨çª—å£å³ä¸ºæŸ¥æ‰¾è¡¨æœ¬èº«ï¼ˆæ§åˆ¶æŸ¥æ‰¾è¡¨çš„å¤§å°å³å¯æ§åˆ¶çª—å£å¤§å°ï¼‰
        TreeSet set = new TreeSet<>();
        for (int i = 0; i < nums.length; i++) {
            // è¾¹æ·»åŠ è¾¹æŸ¥æ‰¾
            // æŸ¥æ‰¾è¡¨ä¸­æ˜¯å¦æœ‰å¤§äºç­‰äº nums[i] - t ä¸”å°äºç­‰äº nums[i] + t çš„å€¼
            Long ceiling = set.ceiling((long) nums[i] - (long) t);
            if (ceiling != null && ceiling <= ((long) nums[i] + (long) t)) {
                return true;
            }
            // æ·»åŠ åï¼Œæ§åˆ¶æŸ¥æ‰¾è¡¨ï¼ˆçª—å£ï¼‰å¤§å°ï¼Œç§»é™¤çª—å£æœ€å·¦è¾¹å…ƒç´ 
            set.add((long) nums[i]);
            if (set.size() == k + 1) {
                set.remove((long) nums[i - k]);
            }
        }
        return false;
    }
}
```

**å¤æ‚åº¦åˆ†æ**ï¼š

- æ—¶é—´å¤æ‚åº¦ï¼šğ‘‚(ğ‘logğ¾)O(Nlogâ¡K)ï¼Œéå†æ•°ç»„ä½¿ç”¨ ğ‘‚(ğ‘)O(N)ï¼Œåœ¨éå†çš„åŒæ—¶å‘äºŒå‰æœç´¢æ ‘ä¸­æ’å…¥å…ƒç´ å’Œç§»é™¤å…ƒç´ çš„æ—¶é—´å¤æ‚åº¦æ˜¯ ğ‘‚(logğ¾)O(logâ¡K)ã€‚
- ç©ºé—´å¤æ‚åº¦ï¼šğ‘‚(1)O(1)ã€‚

å¦ä¸€ç§å†™æ³•ï¼šåœ¨ä¸€å¼€å§‹å°±æŠŠæ»‘åŠ¨çª—å£å·¦è¾¹çš„å…ƒç´ åˆ é™¤ã€‚

**å‚è€ƒä»£ç  3**ï¼š

Java

```Java
import java.util.TreeSet;

public class Solution11 {

    public boolean containsNearbyAlmostDuplicate(int[] nums, int k, int t) {
        int len = nums.length;
        // ç‰¹åˆ¤
        if (len == 0 || k <= 0 || t < 0) {
            return false;
        }

        TreeSet set = new TreeSet<>();

        for (int i = 0; i < len; i++) {
            if (i > k) {
                set.remove((long) nums[i - k - 1]);
            }

            Long ceiling = set.ceiling((long) nums[i] - (long) t);
            if (ceiling != null && ceiling <= (long) nums[i] + (long) t) {
                return true;
            }

            set.add((long) nums[i]);
        }
        return false;
    }
}
```

**å¤æ‚åº¦åˆ†æ**ï¼šï¼ˆåŒä¸Šï¼‰