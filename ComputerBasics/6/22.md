## ã€ŒåŠ›æ‰£ã€ç¬¬ 147 é¢˜ï¼šå¯¹é“¾è¡¨è¿›è¡Œæ’å…¥æ’åºï¼ˆä¸­ç­‰ï¼‰

- è‹±æ–‡ç½‘å€ï¼š[147. Insertion Sort List](https://leetcode.com/problems/insertion-sort-list/description/) ï¼›
- ä¸­æ–‡ç½‘å€ï¼š[147. å¯¹é“¾è¡¨è¿›è¡Œæ’å…¥æ’åº](https://leetcode-cn.com/problems/insertion-sort-list/description/) ã€‚

æˆ‘å†™çš„é¢˜è§£åœ°å€ï¼šhttps://leetcode-cn.com/problems/insertion-sort-list/solution/chuan-zhen-yin-xian-by-liweiwei1419-2/

> å¯¹é“¾è¡¨è¿›è¡Œæ’å…¥æ’åºã€‚
>
> 
>
> ![img](https://upload.wikimedia.org/wikipedia/commons/0/0f/Insertion-sort-example-300px.gif)
>
> **img**
>
> 
>
> æ’å…¥æ’åºçš„åŠ¨ç”»æ¼”ç¤ºå¦‚ä¸Šã€‚ä»ç¬¬ä¸€ä¸ªå…ƒç´ å¼€å§‹ï¼Œè¯¥é“¾è¡¨å¯ä»¥è¢«è®¤ä¸ºå·²ç»éƒ¨åˆ†æ’åºï¼ˆç”¨é»‘è‰²è¡¨ç¤ºï¼‰ã€‚
> æ¯æ¬¡è¿­ä»£æ—¶ï¼Œä»è¾“å…¥æ•°æ®ä¸­ç§»é™¤ä¸€ä¸ªå…ƒç´ ï¼ˆç”¨çº¢è‰²è¡¨ç¤ºï¼‰ï¼Œå¹¶åŸåœ°å°†å…¶æ’å…¥åˆ°å·²æ’å¥½åºçš„é“¾è¡¨ä¸­ã€‚
>
> æ’å…¥æ’åºç®—æ³•ï¼š
>
> 1. æ’å…¥æ’åºæ˜¯è¿­ä»£çš„ï¼Œæ¯æ¬¡åªç§»åŠ¨ä¸€ä¸ªå…ƒç´ ï¼Œç›´åˆ°æ‰€æœ‰å…ƒç´ å¯ä»¥å½¢æˆä¸€ä¸ªæœ‰åºçš„è¾“å‡ºåˆ—è¡¨ã€‚
> 2. æ¯æ¬¡è¿­ä»£ä¸­ï¼Œæ’å…¥æ’åºåªä»è¾“å…¥æ•°æ®ä¸­ç§»é™¤ä¸€ä¸ªå¾…æ’åºçš„å…ƒç´ ï¼Œæ‰¾åˆ°å®ƒåœ¨åºåˆ—ä¸­é€‚å½“çš„ä½ç½®ï¼Œå¹¶å°†å…¶æ’å…¥ã€‚
> 3. é‡å¤ç›´åˆ°æ‰€æœ‰è¾“å…¥æ•°æ®æ’å…¥å®Œä¸ºæ­¢ã€‚
>
> ç¤ºä¾‹ 1ï¼š
>
> ```
> è¾“å…¥: 4->2->1->3
> è¾“å‡º: 1->2->3->4
> ```
>
> ç¤ºä¾‹ 2ï¼š
>
> ```
> è¾“å…¥: -1->5->3->4->0
> è¾“å‡º: -1->0->3->4->5
> ```

Java ä»£ç ï¼š

java

```java
public class Solution {

    public ListNode insertionSortList(ListNode head) {
        ListNode dummyNode = new ListNode(-1);

        ListNode curNode = head;
        while (curNode != null) {
            // ç¬¬ 1 æ­¥ï¼šå…ˆæŠŠä¸‹ä¸€ä¸ªç»“ç‚¹å­˜ä¸€ä¸‹ï¼Œä¸‹ä¸€æ¬¡éå†å°±ä» nextNode å¼€å§‹
            ListNode nextNode = curNode.next;

            // ç¬¬ 2 æ­¥ï¼šéœ€è¦æ‰¾åˆ°è¦æ’å…¥çš„ä½ç½®çš„å‰ä¸€ä¸ªç»“ç‚¹çš„ä½ç½®ï¼Œè¿™éœ€è¦ä»å‰å‘åæ‰¾ï¼Œè¿™ä¸€ç‚¹éå¸¸ä¸ä¸€æ ·
            // æ¯ä¸€æ¬¡ preNode éƒ½å¾—ä»å¤´å¼€å§‹
            ListNode preNode = dummyNode;

            // å› ä¸ºæœ‰ preNode.next ï¼Œæ‰€ä»¥åº”è¯¥å…ˆåˆ¤æ–­éç©º
            while (preNode.next != null && preNode.next.val < curNode.val) {
                // ä¸¥æ ¼å°äºå°±å¯ä»¥äº†ï¼Œæ²¡æœ‰å¿…è¦ç§»åˆ°å°äºç­‰äºçš„æœ€åä¸€ä¸ªï¼Œä¸ç”¨ä¿è¯ç¨³å®šæ€§
                preNode = preNode.next;
            }
            // é€€å‡ºå¾ªç¯çš„æ—¶å€™ï¼ŒpreNode.next.val >= curNode.val
            // ç¬¬ 3 æ­¥ï¼šç©¿é’ˆå¼•çº¿
            curNode.next = preNode.next;
            preNode.next = curNode;

            // ç¬¬ 4 æ­¥ï¼šå¾ªç¯å˜é‡æ›´æ–°
            curNode = nextNode;
        }
        return dummyNode.next;
    }

    public static void main(String[] args) {
        int[] nums = new int[]{3, 7, 9, 10, 8};
        ListNode head = new ListNode(nums);
        Solution3 solution3 = new Solution3();
        ListNode insertionSortList = solution3.insertionSortList(head);
        System.out.println(insertionSortList);
    }
}
```

**å¤æ‚åº¦åˆ†æ**ï¼š

- æ—¶é—´å¤æ‚åº¦ï¼š ğ‘‚(ğ‘2)O(N2) ï¼Œè¿™é‡Œ ğ‘N è¡¨ç¤ºé“¾è¡¨ç»“ç‚¹çš„ä¸ªæ•°ï¼Œå¯¹äºæ¯ä¸ªç»“ç‚¹æ‰¾åˆé€‚ä½ç½®æ—¶ï¼Œæœ€å¤šéœ€è¦éå† ğ‘‚(ğ‘)O(N) æ¬¡ã€‚
- ç©ºé—´å¤æ‚åº¦ï¼šğ‘‚(1)O(1)ã€‚

åˆ†æï¼šè¿™é“é¢˜çš„é¢˜æ„æˆ‘ä»¬æ„Ÿè§‰æœ‰é‚£ä¹ˆäº›è¯¯å¯¼æˆ‘ä»¬çš„æ„æ€ï¼Œæˆ‘ä»¬èƒ½æƒ³åˆ°ä»å¤´å¼€å§‹æ‰¾ç»“ç‚¹åº”è¯¥æ’å…¥çš„ä½ç½®ï¼Œä½†æ„Ÿè§‰è¿™ç§åšæ³•åˆä¸åƒæ’å…¥æ’åºã€‚è§£å†³è¿™ä¸ªé—®é¢˜ä¸è¦å¤ªæ­»æ¿ï¼Œä¸è¦æ€•éº»çƒ¦æˆ‘è§‰å¾—æ˜¯è§£è¿™é“é—®é¢˜çš„å…³é”®ï¼ˆè¿™å¥è¯æ„Ÿè§‰è·Ÿæ²¡è¯´ä¸€ä¸ªæ ·ï¼Œ^_^ï¼‰ã€‚

1. æ’å…¥æ’åºæ¯æ¬¡ä¼šå°†éå†åˆ°çš„ä¸€ä¸ªå…ƒç´ æ’å…¥åˆ°å·²ç»æ’åºçš„éƒ¨åˆ†ï¼›
2. ç†Ÿæ‚‰æ’å…¥æ’åºçš„æœ‹å‹ä»¬éƒ½çŸ¥é“ï¼Œè¿™ç§æ’å…¥è¿‡ç¨‹æ˜¯ä»åå‘å‰çš„ï¼Œä½†æ˜¯å¯¹äºå•é“¾è¡¨æ¥è¯´ï¼Œåªä¿å­˜äº†å½“å‰ç»“ç‚¹åˆ°ä¸‹ä¸€ä¸ªç»“ç‚¹çš„ next æŒ‡é’ˆï¼Œå¹¶æ²¡æœ‰ä¿å­˜ä»å½“å‰ç»“ç‚¹åˆ°ä¸Šä¸€ä¸ªèŠ‚ç‚¹çš„ pre æŒ‡é’ˆï¼›
3. æˆ‘ä»¬å°±è¦å˜æ¢æ€è·¯äº†ï¼Œæ¯æ¬¡éƒ½è¦ä»é“¾è¡¨çš„ç¬¬ 1 ä¸ªå…ƒç´ å¼€å§‹ï¼Œæ‰¾åˆ°æ–°éå†çš„èŠ‚ç‚¹é€‚åˆæ’å…¥çš„ä½ç½®ï¼Œè¿›è¡Œç©¿é’ˆå¼•çº¿ï¼›
4. å…·ä½“æ¥è¯´å¯¹äºå•é“¾è¡¨çš„ç¬¬ 1 ä¸ªå…ƒç´ ï¼Œæ¶‰åŠåˆ°å¤´ç»“ç‚¹çš„æ“ä½œçš„æ—¶å€™ï¼Œæˆ‘ä»¬çš„åšæ³•å¾€å¾€æ˜¯è®¾è®¡ä¸€ä¸ªè™šæ‹Ÿå¤´ç»“ç‚¹ï¼Œä»¥ç®€åŒ–ç¼–ç ã€‚
   ç»¼ä¸Šæ‰€è¿°ï¼Œæƒ³æ¸…æ¥šä¸Šé¢çš„é—®é¢˜ï¼Œå†™å‡ºæ­£ç¡®çš„ä»£ç åº”è¯¥ä¸æ˜¯éš¾äº‹ã€‚

ä¸ºä¸€ä¸ªé“¾è¡¨å®ç°æ’å…¥æ’åºã€‚

![LeetCode ç¬¬ 147 é¢˜ï¼šå•é“¾è¡¨çš„æ’å…¥æ’åº-1](https://liweiwei1419.gitee.io/images/leetcode-solution/147-1.jpg)

**LeetCode ç¬¬ 147 é¢˜ï¼šå•é“¾è¡¨çš„æ’å…¥æ’åº-1**

![LeetCode ç¬¬ 147 é¢˜ï¼šå•é“¾è¡¨çš„æ’å…¥æ’åº-2](https://liweiwei1419.gitee.io/images/leetcode-solution/147-2.jpg)

**LeetCode ç¬¬ 147 é¢˜ï¼šå•é“¾è¡¨çš„æ’å…¥æ’åº-2**



Java ä»£ç ï¼š

java

```java
class ListNode {
    int val;
    ListNode next;

    ListNode(int x) {
        val = x;
    }

    public ListNode(int[] nums) {
        if (nums == null || nums.length == 0) {
            throw new IllegalArgumentException("arr can not be empty");
        }
        this.val = nums[0];
        ListNode curr = this;
        for (int i = 1; i < nums.length; i++) {
            curr.next = new ListNode(nums[i]);
            curr = curr.next;
        }
    }

    @Override
    public String toString() {
        StringBuilder s = new StringBuilder();
        ListNode cur = this;
        while (cur != null) {
            s.append(cur.val + " -> ");
            cur = cur.next;
        }
        s.append("NULL");
        return s.toString();
    }
}

public class Solution {

    public ListNode insertionSortList(ListNode head) {
        // å…ˆå†™æœ€ç‰¹æ®Šçš„æƒ…å†µ
        if (head == null) {
            return null;
        }
        ListNode dummyNode = new ListNode(-1);
        dummyNode.next = head;
        ListNode curNode = head;
        ListNode pre;
        ListNode next;
        while (true) {
            // å¦‚æœéå†ä¸‹å»ï¼Œæ˜¯é¡ºåºæ’åˆ—çš„è¯ï¼Œé‚£æœ€ç®€å•äº†ï¼ŒcurNode æŒ‡é’ˆå‘å‰å°±è¡Œäº†
            // è¿™ä¸€æ­¥æ˜¯ä¸€ä¸ªå¾ªç¯çš„è¿‡ç¨‹
            // æš‚å­˜å½“å‰ç»“ç‚¹çš„ä¸‹ä¸€ç»“ç‚¹
            while (curNode.next != null && curNode.val <= curNode.next.val) {
                curNode = curNode.next;
            }
            // ä¸‹é¢é’ˆå¯¹ä¸Šä¸€æ­¥è·³å‡ºå¾ªç¯çš„ä¸¤ä¸ªæ¡ä»¶è¿›è¡Œç‰¹æ®Šå¤„ç†
            if (curNode.next == null) {
                // å¦‚æœåé¢æ²¡æœ‰å…ƒç´ äº†ï¼Œé‚£å°±è¯´æ˜ï¼Œæ­¤æ—¶é“¾è¡¨å·²ç»æœ‰åºï¼Œå¯ä»¥ç»“æŸæˆ‘ä»¬çš„æ’åºé€»è¾‘äº†
                break;
            } else {
                // å¦åˆ™å°±ä¸€å®šæ»¡è¶³ curNode.val > curNode.next.val; ä¸ºçœŸ
                // pre æ‰“å›åˆ°èµ·ç‚¹
                pre = dummyNode;
                next = curNode.next;
                // æŠŠ pre æŒªåˆ°å¯ä»¥æ”¾ç½® next ç»“ç‚¹çš„ä¸Šä¸€ä¸ªä½ç½®
                while (pre.next.val < next.val) {
                    pre = pre.next;
                }
                // ç©¿é’ˆå¼•çº¿çš„ 3 ä¸ªæ­¥éª¤ï¼Œè¯·è§å›¾ https://liweiwei1419.github.io/images/leetcode-solution/147-1.jpg
                // ç©¿é’ˆå¼•çº¿æ­¥éª¤ 1
                curNode.next = next.next;
                // ç©¿é’ˆå¼•çº¿æ­¥éª¤ 2
                next.next = pre.next;
                // ç©¿é’ˆå¼•çº¿æ­¥éª¤ 2
                pre.next = next;
            }
        }
        return dummyNode.next;
    }

    public static void main(String[] args) {
        int[] nums = new int[]{3, 7, 9, 10, 8};
        ListNode head = new ListNode(nums);
        Solution solution = new Solution();
        ListNode insertionSortList = solution.insertionSortList(head);
        System.out.println(insertionSortList);
    }
}
```

ç­‰ä»·å†™æ³•ï¼š

Java ä»£ç ï¼š

java

```java
public class Solution2 {

    public ListNode insertionSortList(ListNode head) {
        if (head == null) {
            return null;
        }
        // è™šæ‹Ÿå¤´ç»“ç‚¹
        ListNode dummyNode = new ListNode(-1);
        ListNode preNode = dummyNode;
        // ç”¨äºéå†çš„æŒ‡é’ˆ
        ListNode curNode = head;
        ListNode next = null;
        // æ²¡æœ‰è¿™ä¸€æ­¥ï¼šdummyNode.next = head;
        while (curNode != null) {
            next = curNode.next;
            // è¿™ä¸€æ­¥æ˜¯æ‰¾åˆ°ä¸€ä¸ªæ­£ç¡®çš„ä½ç½®æ’å…¥ï¼Œåªè¦æ¯” curNode çš„å€¼å°ï¼Œéƒ½åº”è¯¥è·³è¿‡
            // ç›´åˆ°é‡åˆ°ç¬¬ 1 ä¸ªå¤§äºç­‰äºå®ƒçš„å…ƒç´ 
            while (preNode.next != null && preNode.next.val < curNode.val) {
                preNode = preNode.next;
            }
            // åº”è¯¥æŠŠ node æ”¾åœ¨ pre çš„ä¸‹ä¸€ä¸ª
            curNode.next = preNode.next;
            preNode.next = curNode;
            preNode = dummyNode;
            curNode = next;
        }
        return dummyNode.next;
    }

    public static void main(String[] args) {
        int[] nums = new int[]{3, 7, 9, 10, 8};
        ListNode head = new ListNode(nums);
        Solution2 solution2 = new Solution2();
        ListNode insertionSortList = solution2.insertionSortList(head);
        System.out.println(insertionSortList);
    }
}
```